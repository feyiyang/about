---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import { getCollection } from 'astro:content';
import { SITE_TITLE, SITE_DESCRIPTION } from '../config';

// Get all entries from a collection. Requires the name of the collection as an argument.
const draftBlogEntries = (await getCollection('blog', (data) => {
  return data.data.draft !== true;
})).sort(
	(a, b) => new Date(b.data.pubDate).valueOf() - new Date(a.data.pubDate).valueOf()
);
---

<!DOCTYPE html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<main class="main">
			<section class="viewsec">
				<h2></h2>
			</section>
			<section class="demosec">
				<h2 class="dtitle">Demos</h2>
				<div class="demos">
					<div class="demo">
						<h3>
							<a class="demolink" href="https://encloudmusic.netlify.app/#/" target="_blank">仿QQ音乐</a>
							<a class="hub" href="https://github.com/yikeguo/mytodolist" target="_blank">
								GitHub <img src="/images/link.svg" width="12">
							</a>
						</h3>
						<span class="demo_img">
							<img class="cov" src="/images/music_demo.png" alt="仿QQ音乐">
							<p class="extra">
								{['vite', 'vue3', 'ts', 'vue-router4', 'sass', 'acro-design', 'axios'].map(v => <i>{v}</i>)}
							</p>
						</span>
					</div>
				</div>
			</section>
			<section class="blogsec">
				<h2>Blogs</h2>
				<ul class="arts">
					{draftBlogEntries.map((post) => {
						return (
							<li>
								<time datetime={post.data.pubDate}>
									{new Date(post.data.pubDate).toLocaleDateString('zh-cn', {
										year: 'numeric',
										month: 'short',
										day: 'numeric',
									})}
								</time>
								<a class="link" href={'/posts/' + post.slug}>{post.data.title}</a>
								<p class="tags">
									{post.data.tag && post.data.tag.map(t => <span class="tag">[{t}]</span>)}
								</p>
							</li>
						)
					} )}
				</ul>
			</section>
		</main>
		<Footer />
	</body>
</html>
<style lang="less">
@import '../styles/var.less';
html, body{
	height: 100%;
}
.wraper {
	padding: 10px;
	border-radius: 6px;
}
h2 {
	font-size: 16px;
	padding: 0 0 5px 15px;
}
.main {
	width: 920px;
	margin: auto;
	padding-top: 10px;
	.demosec{
		width: 620px;
		.wraper;
		background-color: @bg_blue;
		.demos {
			display: flex;
			flex-wrap: wrap;
			justify-content: space-between;
			// word-break: break-word;
			.demo {
				width: 49%;
			}
			h3 {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 5px 15px;
				background-color: #fff;
				border-radius: 4px 4px 0 0;
				.hub {
					color: @text_grey;
					font-size: 12px;
				}
			}
			.demo_img {
				position: relative;
				display: block;
				padding: 15px;
				border-radius: 0 0 4px 4px;
				overflow: hidden;
				background-color: #f8fcff;
				img.cov {
					width: 100%;
					height: 170px;
					object-fit: cover;
				}
				.hub {
					position: absolute;
					right: 0;
					top: 0;
					width: 26px;
					img {
						width: 100%;
					}
				}
			}
			.extra {
				color: @text_grey;
				line-height: 1.2;
				i {
					margin-right: 5px;
					font-style: normal;
				}
			}
		}
	}
	.blogsec {
		width: 620px;
		margin-top: 15px;
		.wraper;
		background-color: @bg_green;
		ul, li {
			list-style: none;
		}
		ul.arts {
			display: flex;
			flex-wrap: wrap;
			justify-content: space-between;
			padding-bottom: 40px;
			li {
				width: 49%;
				margin-bottom: 10px;
				border-radius: 2px;
				overflow: hidden;
				background-color: #f0fdfd;
				// box-shadow: 0 1px 4px rgb(145, 160, 175);
				&:nth-of-type(2n + 1) {
					// transform: rotate(-0.6deg);
				}
			}
			.link {
				display: block;
				padding: 10px 15px 5px;
				font-size: 15px;
				line-height: 1.2;
			}
			time {
				display: block;
				padding-right: 5px;
				font-size: 12px;
				text-align: right;
				color: #abaaac;
				background-color: #fff;
			}
			.tags {
				padding: 0 15px 10px;
				font-size: 12px;
				color: #abaaac;
				.tag{
					margin-right: 4px;
				}
			}
		}
	}
	.viewsec {
		float: right;
		width: 260px;
		background-color: @bg_yellow;
	}
}
</style>